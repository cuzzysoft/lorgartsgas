<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Revenue Analysis | Lorgarts Gas</title>

  <link rel="stylesheet" href="../plugins/toastr/toastr.min.css">

  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="../plugins/fontawesome-free/css/all.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
  <link rel="stylesheet" href="../plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
  <link rel="stylesheet" href="../dist/css/adminlte.min.css">

  <!-- Select2 -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="../plugins/bootstrap/js/bootstrap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script>
    function fillLocationData() {
      $.ajax({
        type: "POST",
        url: "https://lorgartsgas.hotelsoft.ng/php/getpaidvia.php",
        success: function (response) {
          let gh = JSON.parse(response);
          $("#transfer").text(gh[0]);
          $("#cash").text(gh[1]);
          $("#pos").text(gh[2]);
          $("#tot").text(gh[3]);
          $("#exp").text(gh[4]);
          $("#kilg").text(gh[5]);
          $("#totl").text(gh[3]);
          $("#profitmargin").text(gh[3] - gh[4]);
        }
      });
      sessionStorage.setItem('location', 10);
    }
  </script>
</head>

<body class="hold-transition sidebar-mini layout-fixed">
  <!-- Site wrapper -->
  <div class="wrapper">

    <nav class="main-header navbar navbar-expand navbar-light">
      <!-- Left navbar links -->
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="modal" data-target="#sell-modal"><img src="img/sell.png"
              style="width:60px;cursor:pointer"></a>
        </li>

        <!--<li class="nav-item d-none d-sm-inline-block">-->
        <!--  <a href="#" class="nav-link">Contact</a>-->
        <!--</li>-->
      </ul>

      <!-- Right navbar links -->
      <ul class="navbar-nav ml-auto text-sm">
        <li class="nav-item">
          <button class="sales-button nav-link" style="color:white" onclick="window.location.href='sales.html'"> Sales
          </button>

        </li>
        <li class="nav-item">
          <a class="nav-link" id="calc" href="#" role="button" data-toggle="modal" title="Calculator"
            data-target="#modal-calculator">
            <i class="fas fa-calculator"></i>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-widget="fullscreen" title="Fullscreen" href="#" role="button">
            <i class="fas fa-expand-arrows-alt"></i>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="outa.php" title="Logout" onclick="return confirm('Do you want to logout?')">
            <i class="fas fa-sign-out-alt"></i>
          </a>
        </li>
      </ul>
    </nav>

    <aside id="sidebar-container" class="main-sidebar sidebar-dark-primary elevation-4 text-sm"></aside>
    <!-- /.sidebar -->


    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
      <!-- Content Header (Page header) -->
      <section class="content-header">
        <div class="container-fluid">
          <div class="row mb-2">
            <div class="col-sm-6">
              <h1>Revenue Analysis</h1>
            </div>
            <div class="col-sm-6">
              <ol class="breadcrumb float-sm-right">
                <li class="breadcrumb-item"><a href="#">Home</a></li>
                <li class="breadcrumb-item active"> Revenue Analysis</li>
              </ol>
            </div>
          </div>
        </div><!-- /.container-fluid -->
      </section>

      <!-- Main content -->


      <div style="font-family: 'Roboto', sans-serif; padding: 20px; color: #333;">
        <!-- Header Section -->


        <!-- Summary Section -->
        <section style="display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 20px;">
          <div
            style="flex: 1; min-width: 150px; padding: 10px; border: 1px solid #ccc; border-radius: 5px; text-align: center; font-size: 18px; background: #e6f7e6; color: #27ae60;">
            Total Income &#x20A6;<span id="tot"></span>
          </div>
          <div
            style="flex: 1; min-width: 150px; padding: 10px; border: 1px solid #ccc; border-radius: 5px; text-align: center; font-size: 18px; background: #fdecec; color: #e74c3c;">
            Total Expenditure: &#x20A6;<span id="exp"></span>
          </div>
          <div
            style="flex: 1; min-width: 150px; padding: 10px; border: 1px solid #ccc; border-radius: 5px; text-align: center; font-size: 18px; background: #f0f9ff; color: #2980b9;">
            Total Kilogram Sold: <span id="kilg"></span>
          </div>
          <div
            style="flex: 1; min-width: 150px; padding: 10px; border: 1px solid #ccc; border-radius: 5px; text-align: center; font-size: 18px; background: #fff8e6; color: #f39c12;">
            Profit Margin: <span id="profitmargin"></span>
          </div>
          <div style="width:100%">
            <table style="width: 100%; border-collapse: collapse; min-width: 100%;">
              <thead>
                <tr style="background-color: #f4f4f4;">
                  <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Type</th>
                  <th style="border: 1px solid #ddd; padding: 8px; text-align: left;"> Amount</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="border: 1px solid #ddd; padding: 8px;">Transfer</td>
                  <td style="border: 1px solid #ddd; padding: 8px;"><span id="transfer"></span></td>
                </tr>
                <tr>
                  <td style="border: 1px solid #ddd; padding: 8px;">Cash</td>
                  <td style="border: 1px solid #ddd; padding: 8px;"><span id="cash"></span></td>
                </tr>
                <tr>
                  <td style="border: 1px solid #ddd; padding: 8px;">POS</td>
                  <td style="border: 1px solid #ddd; padding: 8px;"><span id="pos"></span></td>
                </tr>
                <tr>
                  <td style="border: 1px solid #ddd; padding: 8px;"><b>Total Income</b></td>
                  <td style="border: 1px solid #ddd; padding: 8px;"><b><span id="totl"></span></b></td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>


        <!-- Transactions Section -->
        <section style="display:none">
          <h2 style="margin-bottom: 10px;">Income and Expenditure</h2>
          <div style="overflow-x: auto;">
            <table style="width: 100%; border-collapse: collapse; min-width: 600px;">
              <thead>
                <tr style="background-color: #f4f4f4;">
                  <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Date</th>
                  <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Description</th>
                  <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Income</th>
                  <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Expenditure</th>
                  <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Net Total</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="border: 1px solid #ddd; padding: 8px;">2024-12-28</td>
                  <td style="border: 1px solid #ddd; padding: 8px;">Gas Sales</td>
                  <td style="border: 1px solid #ddd; padding: 8px;">$1,500</td>
                  <td style="border: 1px solid #ddd; padding: 8px;">$0</td>
                  <td style="border: 1px solid #ddd; padding: 8px;">$1,500</td>
                </tr>
                <tr>
                  <td style="border: 1px solid #ddd; padding: 8px;">2024-12-28</td>
                  <td style="border: 1px solid #ddd; padding: 8px;">Gas Purchase</td>
                  <td style="border: 1px solid #ddd; padding: 8px;">$0</td>
                  <td style="border: 1px solid #ddd; padding: 8px;">$1,200</td>
                  <td style="border: 1px solid #ddd; padding: 8px;">-$1,200</td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>


      </div>



      <!-- /.content -->
    </div>
    <!-- /.content-wrapper -->

    <div class="modal fade" id="signoutModal" tabindex="-1" role="dialog">
      <div class="modal-dialog modal-sm">
        <div class="modal-content">
          <form method="post" action="cashieraction.php">

            <div class="modal-header">
              <h4 class="modal-title">P.A Action</h4>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="card-body">
              <select class="custom-select" style="width: 10em;margin-left:3em" name="caction">
                <option value="Pending">Pending</option>
                <option value="Accepted">Accept</option>
                <option value="Rejected">Reject</option>
              </select>
            </div>

            <input type="hidden" id="cusid" name="cusid">

            <div class="modal-footer justify-content-between">
              <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
              <button type="submit" name="submit" class="btn btn-primary">Save</button>
            </div>
          </form>
        </div>
      </div>
    </div>
<input type="hidden" id="unit_pricefill" class="form-control" >
    <div class="modal fade" id="posModal" tabindex="-1" role="dialog">
      <div class="modal-dialog modal-sm">
        <div class="modal-content">
          <form method="post" action="cashieraction2.php">

            <div class="modal-header">
              <h4 class="modal-title">POS Action</h4>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="card-body">
              <select class="custom-select" style="width: 10em;margin-left:3em" name="caction2">
                <option value="Pending">Pending</option>
                <option value="Accepted">Accept</option>
                <option value="Rejected">Reject</option>
              </select>
            </div>

            <input type="hidden" id="cusid2" name="cusid2">

            <div class="modal-footer justify-content-between">
              <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
              <button type="submit" name="submit" class="btn btn-primary">Save</button>
            </div>
          </form>
        </div>
      </div>
    </div>
     <div class="modal fade" id="sell-modal">
            <div class="modal-dialog">
                <div class="modal-content">
                    <form method="post" id="sellform">
                        <div class="modal-header">
                            <h4 class="modal-title">Sell</h4>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>

                        <div class="modal-body">
                            <div class="col-md-12">
                                <div class="card card-primary">

                                    <div class="card-body">

                                        <div class="form-group">
                                            <label for="inputName">Customer</label>
                                            <select class="form-control" name="customer" id="customer">
                                                <option value="">--select customer--</option>
                                            </select>

                                        </div>

                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="form-group">
                                                    <label for="inputName"> Date</label>
                                                    <input type="datetime-local" id="selldate" name="selldate" required
                                                        class="form-control">
                                                </div>

                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="form-group">
                                                    <label for="inputName"> Quantity (Kg)</label>
                                                    <input type="number" step="0.01" id="lpg_qty" name="lpg_qty"
                                                        onkeyup="handleKeyUp(event)" required class="form-control">
                                                </div>
                                            </div>
                                        </div>
                                        <input type="hidden" id="hiddenid" name="hiddenid" value="">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="inputName"> Total Price </label>
                                                    <input type="text" id="lpg_price" onkeyup="handlePriceKeyUp(event)"
                                                        name="lpg_price" class="form-control">
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="inputName"> Paid Via</label>
                                                    <select class="form-control" required name="pvia" id="pvia"
                                                        onchange="showSelAcc(event)">
                                                        <option value="">--select--</option>
                                                        <option value="Cash">Cash</option>
                                                        <option value="Transfer"> Bank Transfer</option>
                                                        <option value="POS">POS</option>
                                                        <option value="Unpaid">Unpaid</option>
                                                    </select>
                                                </div>
                                            </div>

                                            <div class="col-md-12" id="sel_accdiv" style="display: none;">
                                                <div class="form-group">
                                                    <label for="inputName"> Select Account</label>
                                                    <select class="form-control" name="sel_acc" id="sel_acc">
                                                        <option value="">--select--</option>
                                                    </select>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- /.card-body -->

                                </div>
                                <!-- /.card -->
                            </div>
                        </div>
                        <div class="modal-footer justify-content-between" style="padding-top: 0px; margin-top:0px">
                            <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                            <button type="submit" id="selsubmit" name="submit" class="btn btn-primary">Submit</button>
                        </div>
                    </form>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
        </div>
    <footer class="main-footer">
      <div class="float-right d-none d-sm-block">
        <!--<b>Version</b> 1.0-->
      </div>
      <strong>Copyright &copy;
        <span id="footerdate"></span> <a href="index.html">Lorgarts Gas</a>.
      </strong> All rights reserved.
    </footer>

    <!-- Control Sidebar -->
    <aside class="control-sidebar control-sidebar-dark">
      <!-- Control sidebar content goes here -->
    </aside>
    <!-- /.control-sidebar -->
  </div>
  <!-- ./wrapper -->


  <script src="../plugins/jquery/jquery.min.js"></script>
  <script src="../plugins/bootstrap/js/bootstrap.bundle.min.js"></script>

  <script src="../dist/js/adminlte.min.js"></script>
  <script src="../plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>
  <script>
    $('.table').on('click', 'tbody tr', function (event) {
      $(this).addClass('highlight').siblings().removeClass('highlight');
    })
  </script>

  <!-- ChartJS -->
  <script src="../plugins/chart.js/Chart.min.js"></script>

  <script>
    fillLocationData();

    $.ajax({
      url: 'https://lorgartsgas.hotelsoft.ng/php/get_chart_data.php', // PHP file to fetch data
      type: 'GET',
      success: function (response) {
        console.log('Chart Data:', response);

        // Render Bar Chart
        const barCtx = document.getElementById('barChart').getContext('2d');
        new Chart(barCtx, {
          type: 'bar',
          data: {
            labels: response.barChart.labels,
            datasets: [
              {
                label: 'Income',
                backgroundColor: 'rgba(60, 141, 188, 0.8)',
                data: response.barChart.income
              },
              {
                label: 'Expenditure',
                backgroundColor: 'rgba(210, 214, 222, 0.8)',
                data: response.barChart.expenditure
              }
            ]
          },
          options: {
            responsive: true,
            plugins: {
              legend: {
                display: true,
                position: 'top'
              }
            }
          }
        });

        // Render Pie Chart
        const pieCtx = document.getElementById('pieChart').getContext('2d');
        new Chart(pieCtx, {
          type: 'pie',
          data: {
            labels: response.pieChart.labels,
            datasets: [{
              data: response.pieChart.values,
              backgroundColor: [
                'rgba(60, 141, 188, 0.8)',
                'rgba(210, 214, 222, 0.8)',
                'rgba(255, 99, 132, 0.8)',
                'rgba(75, 192, 192, 0.8)'
              ]
            }]
          },
          options: {
            responsive: true,
            plugins: {
              legend: {
                display: true,
                position: 'top'
              }
            }
          }
        });
      },
      error: function (error) {
        console.error('Error fetching chart data:', error);
      }
    });
  </script>
  <script src="footer.js"></script>
</body>

</html>